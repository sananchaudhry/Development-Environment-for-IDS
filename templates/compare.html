{% extends "base.html" %}
{% block content %}
<h2>Compare Runs</h2>

{% if errors %}
  <div class="alert alert-danger">
    <ul class="mb-0">{% for err in errors %}<li>{{ err }}</li>{% endfor %}</ul>
  </div>
{% endif %}

<form method="get" action="/compare" class="mb-4 p-3 border rounded bg-light">
  <div class="row g-3 align-items-end">
    <div class="col-md-5">
      <label class="form-label">Run A</label>
      <select name="run_a" class="form-select compact-field">
        <option value="" {% if not selected_a %}selected{% endif %}>Select a run</option>
        {% for run in runs %}
          <option value="{{ run.id }}" {% if selected_a == run.id %}selected{% endif %}>
            {{ run.run_name or ('Run #' ~ run.id) }} — {{ run.model }} ({{ run.timestamp }})
          </option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-5">
      <label class="form-label">Run B</label>
      <select name="run_b" class="form-select compact-field">
        <option value="" {% if not selected_b %}selected{% endif %}>Select another run</option>
        {% for run in runs %}
          <option value="{{ run.id }}" {% if selected_b == run.id %}selected{% endif %}>
            {{ run.run_name or ('Run #' ~ run.id) }} — {{ run.model }} ({{ run.timestamp }})
          </option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-2 d-flex justify-content-end">
      <button type="submit" class="btn btn-primary w-100">Compare</button>
    </div>
  </div>
  <div class="form-text">Pick two finished runs to view them side-by-side without rerunning training.</div>
</form>

<div class="row g-3 comparison-grid">
  <div class="col-12 col-xl-6">
    {% with selected_run=run_a, card_id='a' %}
      {% include 'partials/run_compare_card.html' %}
    {% endwith %}
  </div>
  <div class="col-12 col-xl-6">
    {% with selected_run=run_b, card_id='b' %}
      {% include 'partials/run_compare_card.html' %}
    {% endwith %}
  </div>
</div>
{% endblock %}
